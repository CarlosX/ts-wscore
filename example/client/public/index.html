<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Mi sitio web</title>
        <style>
            .console {
                font-family: monospace;
                font-size: 14px;
                background-color: black;
                color: white;
                border: none;
                resize: none;
            }
            button {
                display: block;
            }
        </style>
    </head>
    <body>
        <textarea id="messages" class="console" rows="10" cols="80"></textarea>
        <script>
            const socket = new WebSocket('ws://localhost:3000')
            const messagesTextarea = document.getElementById('messages')

            socket.addEventListener('open', (event) => {
                console.log('Connection opened')
            })

            socket.addEventListener('message', (event) => {
                console.log(`Recv: ${event.data}`)
                messagesTextarea.value += JSON.parse(event.data).data + '\n'
            })

            socket.addEventListener('close', (event) => {
                console.log('Connection closed')
            })

            socket.addEventListener('error', (event) => {
                console.error('Error', event)
            })

            function sendTestMsg() {
                const data = {
                    opcode: '1',
                    data: {
                        name: 'Test',
                        lastName: 'Dev'
                    }
                }
                socket.send(JSON.stringify(data))
            }
        </script>

        <button onclick="sendTestMsg()">Send Test</button>
    </body>
</html>
